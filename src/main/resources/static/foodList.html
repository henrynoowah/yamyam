<!DOCTYPE html>
<html>

<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>얌얌 꿀떡!</title>

    <style>

        body {
            background-color: #FFE2EE;;
            margin: 0px;
        }

        #header{
            width: 100%;
            height: 60px;
            background-color: white;
            margin-bottom: 10px;
        }

        #header a {
            text-decoration: none;
        }

        .navContents {
            width: 80%;
            margin: auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .navLinks {
            width: 40%;
            display: flex;
            align-content: flex-end;
            justify-content: space-between;
        }
        
        .navLinks li {
            list-style: none;
        }

        .searchTool {
            width: 60%;
            margin: auto;
        }
        
        .foodCards {
            /* border: 1px solid black; */
            width: 60%;
            margin: auto;
            display: grid;
            grid-gap: 0.4rem;
            grid-template-columns: repeat(3, 1fr);
            grid-auto-rows: 1fr;
        }
        
        .card {
            background-color: white;
            width: 100%;
            margin: auto;
            border-radius: 10px;
            aspect-ratio: 1/1;
            align-content: center;
            
            cursor: pointer;
            transform-style: preserve-3d;
            transform-style: preserve-3d;
            transition: ease-in 0.3s;
            transform: perspective(600px) rotateY(0deg);     
        }
        
        .flip {
            transform: perspective(600px) rotateY(180deg);
        }

        .card:hover {
            background-color: blanchedalmond;
            /* transform: perspective(600px) rotateY(180deg); */
        }
    
    </style>

</head>


<body>
    
    <div id="foodListContainer">

        <div id="header">
            <header-nav class="headerNav"></header-nav>
        </div>

        <div class="searchTool">
            여기에 서치바랑 카테고리 버튼들이 들어갈꺼임!
            <hr>
        </div>

        <div class="foodCards">
            <div class="card" v-for="food, i in foodList" @click="flipCard($event.path[0], food.id)">
                <!-- 앞에 부분 -->
                <div v-if="flip[food[i]]">
                    <!-- {{flip[food.id]}} -->
                    {{food.name}}
                </div>
                <!-- 돌렸을 때 -->
                <div>
                    {{food.dog}} : {{food.cat}}
                </div>
            </div>
        </div>

    </div>

    <template id="headerNav">
        <div class="navContents">
            <a href="foodList.html"><h3>Yam! Yam!</h3></a>
            <ul class="navLinks">
                <li><a href="myPage">My Page</a></li>
                <li><a href="myFavorites">Favorites</a></li>
                <li v-if="user.admin == 1"><a href="addFood">Add Food</a></li>
                <li><button @click="logout">Log Out</a></li>
            </ul>
        </div>
    </template>

    <script>
        
        Vue.component("header-nav", {
            template: "#headerNav",
            data() {
                return {
                    user: null
                }
            },
            created() {
                this.user = JSON.parse(sessionStorage.getItem("user"));
            },
            methods: {
                logout() {
                    axios({
                        method: "get",
                        url: "/logout"
                    }).then(res => {
                        window.location.href = res.data;
                        sessionStorage.removeItem("user");
                    }).catch(err => {
                        alert(err.response.data);
                    })
                },
            },
        });

        new Vue({
            el: "#foodListContainer",
            data: {
                foodList: [],
                flip: []
            },
            mounted() {
                axios.get("/foodListAll").then(res => {
                    console.log(res.data)
                    this.foodList = res.data;
                    this.foodList.forEach((v, i) => {
                        this.flip[i] = true;
                    })
                })
            },
            methods: {
                flipCard(foodCard, id) {
                    foodCard.classList.toggle('flip')
                    this.flip[id] = !this.flip[id];
                    console.log(this.flip[id]);
                }
            }
        });

    </script>

</body>

</html>

